<!DOCTYPE HTML>
<html lang="zh" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>速查手册 - 从pandas到polars</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        
        <link rel="stylesheet" href="css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="cheat_sheet.html"><strong aria-hidden="true">1.</strong> 速查手册</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">从pandas到polars</h1>

                    <div class="right-buttons">
                        
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <ul>
<li><a href="#%E5%88%9B%E5%BB%BA">创建</a>
<ul>
<li><a href="#series">series</a></li>
<li><a href="#dataframe">dataframe</a></li>
</ul>
</li>
<li><a href="#%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE">查看数据</a>
<ul>
<li><a href="#%E8%8E%B7%E5%8F%96%E5%88%97%E5%90%8D">获取列名</a></li>
<li><a href="#%E7%BB%9F%E8%AE%A1%E6%B1%87%E6%80%BB%E6%96%B9%E6%B3%95">统计汇总方法</a>
<ul>
<li><a href="#count">count</a></li>
<li><a href="#mean">mean</a></li>
<li><a href="#%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95">其他方法</a></li>
</ul>
</li>
<li><a href="#%E8%BD%AC%E7%BD%AE">转置</a></li>
<li><a href="#%E6%8E%92%E5%BA%8F">排序</a></li>
</ul>
</li>
<li><a href="#%E6%9F%A5%E8%AF%A2%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE">查询&amp;更新数据</a>
<ul>
<li><a href="#%E8%8E%B7%E5%8F%96%E4%B8%80%E4%B8%AA%E6%88%96%E5%A4%9A%E4%B8%AA%E5%88%97">获取一个或多个列</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E5%88%87%E7%89%87">获取切片</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E6%9F%90%E4%B8%AA%E6%A0%87%E9%87%8F">获取某个标量</a></li>
<li><a href="#%E5%B8%83%E5%B0%94%E7%B4%A2%E5%BC%95">布尔索引</a></li>
<li><a href="#%E6%B7%BB%E5%8A%A0%E6%96%B0%E5%88%97">添加新列</a></li>
<li><a href="#%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE">修改数据</a></li>
</ul>
</li>
<li><a href="#%E7%BC%BA%E5%A4%B1%E5%80%BC%E5%A4%84%E7%90%86">缺失值处理</a>
<ul>
<li><a href="#%E8%BF%87%E6%BB%A4%E6%8E%89%E5%8C%85%E5%90%AB%E7%BC%BA%E5%A4%B1%E5%80%BC%E7%9A%84%E8%A1%8C">过滤掉包含缺失值的行</a></li>
<li><a href="#%E5%A1%AB%E5%85%85%E7%BC%BA%E5%A4%B1%E5%80%BC">填充缺失值</a></li>
</ul>
</li>
</ul>
<hr />
<h2 id="创建"><a class="header" href="#创建">创建</a></h2>
<h3 id="series"><a class="header" href="#series">series</a></h3>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// 从 Vec, 切片和数组, series 可以携带名称
let s = Series::new(&quot;from vec&quot;, vec![1, 2, 3]);
let s = Series::new(&quot;from slice&quot;, &amp;[true, false, true]);
let s = Series::new(&quot;from array&quot;, [&quot;rookie&quot;, &quot;long&quot;, &quot;lin&quot;]);
<span class="boring">}
</span></code></pre></pre>
<h3 id="dataframe"><a class="header" href="#dataframe">dataframe</a></h3>
<p>空 dataframe</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df = DataFrame::default();
assert!(df.is_empty());
<span class="boring">}
</span></code></pre></pre>
<p>从多个 <code>Vec&lt;Series&gt;</code> 创建</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let s1 = Series::new(&quot;Fruit&quot;, &amp;[&quot;Apple&quot;, &quot;Apple&quot;, &quot;Pear&quot;]);
let s2 = Series::new(&quot;Color&quot;, &amp;[&quot;Red&quot;, &quot;Yellow&quot;, &quot;Green&quot;]);

let df: Result&lt;DataFrame&gt; = DataFrame::new(vec![s1, s2]);
<span class="boring">}
</span></code></pre></pre>
<p>使用 <code>df!</code> 宏, <strong>注意, 返回类型为<code>Result&lt;DataFrame&gt;</code></strong></p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df: Result&lt;DataFrame&gt; = df!(&quot;Fruit&quot; =&gt; &amp;[&quot;Apple&quot;, &quot;Apple&quot;, &quot;Pear&quot;],
                                &quot;Color&quot; =&gt; &amp;[&quot;Red&quot;, &quot;Yellow&quot;, &quot;Green&quot;]);
<span class="boring">}
</span></code></pre></pre>
<h2 id="查看数据"><a class="header" href="#查看数据">查看数据</a></h2>
<p>查看头和尾, 与 pandas 中同名函数类似, 
<a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=index#method.head">head</a>, 
<a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=index#method.tail">tail</a></p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let countries: DataFrame =
    df!(
        &quot;Rank by GDP (2021)&quot; =&gt; &amp;[1, 2, 3, 4, 5],
        &quot;Continent&quot; =&gt; &amp;[&quot;North America&quot;, &quot;Asia&quot;, &quot;Asia&quot;, &quot;Europe&quot;, &quot;Europe&quot;],
        &quot;Country&quot; =&gt; &amp;[&quot;United States&quot;, &quot;China&quot;, &quot;Japan&quot;, &quot;Germany&quot;, &quot;United Kingdom&quot;],
        &quot;Capital&quot; =&gt; &amp;[&quot;Washington&quot;, &quot;Beijing&quot;, &quot;Tokyo&quot;, &quot;Berlin&quot;, &quot;London&quot;]
    )?;
assert_eq!(countries.shape(), (5, 4));

println!(&quot;{}&quot;, countries.head(Some(3)));
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>output</summary>
<pre><code class="language-bash">shape: (3, 4)
┌────────────────────┬───────────────┬───────────────┬────────────┐
│ Rank by GDP (2021) ┆ Continent     ┆ Country       ┆ Capital    │
│ ---                ┆ ---           ┆ ---           ┆ ---        │
│ i32                ┆ str           ┆ str           ┆ str        │
╞════════════════════╪═══════════════╪═══════════════╪════════════╡
│ 1                  ┆ North America ┆ United States ┆ Washington │
├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 2                  ┆ Asia          ┆ China         ┆ Beijing    │
├╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌┤
│ 3                  ┆ Asia          ┆ Japan         ┆ Tokyo      │
└────────────────────┴───────────────┴───────────────┴────────────┘
</code></pre>
</details>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let countries: DataFrame =
    df!(&quot;Rank (2021)&quot; =&gt; &amp;[105, 106, 107, 108, 109],
        &quot;Apple Price (€/kg)&quot; =&gt; &amp;[0.75, 0.70, 0.70, 0.65, 0.52],
        &quot;Country&quot; =&gt; &amp;[&quot;Kosovo&quot;, &quot;Moldova&quot;, &quot;North Macedonia&quot;, &quot;Syria&quot;, &quot;Turkey&quot;])?;
assert_eq!(countries.shape(), (5, 3));

println!(&quot;{}&quot;, countries.tail(Some(2)));
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">shape: (2, 3)
┌─────────────┬────────────────────┬─────────┐
│ Rank (2021) ┆ Apple Price (€/kg) ┆ Country │
│ ---         ┆ ---                ┆ ---     │
│ i32         ┆ f64                ┆ str     │
╞═════════════╪════════════════════╪═════════╡
│ 108         ┆ 0.65               ┆ Syria   │
├╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌┤
│ 109         ┆ 0.52               ┆ Turkey  │
└─────────────┴────────────────────┴─────────┘
</code></pre>
</details>
<h3 id="获取列名"><a class="header" href="#获取列名">获取列名</a></h3>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df: DataFrame = df!(&quot;Language&quot; =&gt; &amp;[&quot;Rust&quot;, &quot;Python&quot;],
                        &quot;Designer&quot; =&gt; &amp;[&quot;Graydon Hoare&quot;, &quot;Guido van Rossum&quot;])?;

assert_eq!(df.get_column_names(), &amp;[&quot;Language&quot;, &quot;Designer&quot;]);
<span class="boring">}
</span></code></pre></pre>
<p>如果要获取列值, 可以使用
<a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=index#method.column">column</a>
<a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=index#method.columns">columns</a></p>
<h3 id="统计汇总方法"><a class="header" href="#统计汇总方法">统计汇总方法</a></h3>
<p>polars DataFrame 没有提供 describe 这样的快速统计方法, 但调用 mean, std 等方法也非常简单便捷</p>
<h4 id="count"><a class="header" href="#count">count</a></h4>
<p>对于整个 DataFrame 可以调用 <a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html#method.shape">shape</a>
获取 DataFrame 形状, 如果想获取某个列经操作变形后个数, 可以使用
<a href="https://pola-rs.github.io/polars/polars/prelude/enum.Expr.html#method.count">count</a></p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df1: DataFrame = df!(&quot;D1&quot; =&gt; &amp;[1, 3, 1, 5, 6],
                     &quot;D2&quot; =&gt; &amp;[3, 2, 3, 5, 3])?;
let df2 = df1
    .lazy()
    .select(&amp;[
        col(&quot;D1&quot;).count().alias(&quot;total&quot;),
        col(&quot;D1&quot;).filter(col(&quot;D1&quot;).gt(lit(3))).count().alias(&quot;D1 &gt; 3&quot;),
    ])
    .collect()
    .unwrap();
println!(&quot;{}&quot;, df2);
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">shape: (1, 2)
┌───────┬────────┐
│ total ┆ D1 &gt; 3 │
│ ---   ┆ ---    │
│ u32   ┆ u32    │
╞═══════╪════════╡
│ 5     ┆ 2      │
└───────┴────────┘
</code></pre>
</details>
<h4 id="mean"><a class="header" href="#mean">mean</a></h4>
<p>DataFrame <a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=count#method.mean">mean</a></p>
<p>Expr <a href="https://pola-rs.github.io/polars/polars/prelude/enum.Expr.html#method.mean">mean</a></p>
<p>如果要计算滑动平均等带时间窗口数据, 请查看 <a href="https://pola-rs.github.io/polars/polars/prelude/enum.Expr.html#method.rolling_mean">rolling_mean</a></p>
<h4 id="其他方法"><a class="header" href="#其他方法">其他方法</a></h4>
<p>其他统计学方法名称与 pandas 中同名或类似</p>
<ul>
<li>标准差 <a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=count#method.std">std</a></li>
<li>分位数 <a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=count#method.quantile">quantile</a></li>
<li>最大值 <a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=count#method.max">max</a></li>
<li>最小值 <a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=count#method.min">min</a></li>
<li>中位数 <a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=count#method.median">median</a></li>
</ul>
<h3 id="转置"><a class="header" href="#转置">转置</a></h3>
<p><a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=count#method.transpose">transpose</a>
可转置 DataFrame, <strong>这个操作消耗大量性能</strong></p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df1: DataFrame = df!(&quot;D1&quot; =&gt; &amp;[1, 3, 1, 5, 6],
                         &quot;D2&quot; =&gt; &amp;[3, 2, 3, 5, 3])?;
println!(&quot;{}&quot;, df1.transpose()?);
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">shape: (2, 5)
┌──────────┬──────────┬──────────┬──────────┬──────────┐
│ column_0 ┆ column_1 ┆ column_2 ┆ column_3 ┆ column_4 │
│ ---      ┆ ---      ┆ ---      ┆ ---      ┆ ---      │
│ i32      ┆ i32      ┆ i32      ┆ i32      ┆ i32      │
╞══════════╪══════════╪══════════╪══════════╪══════════╡
│ 1        ┆ 3        ┆ 1        ┆ 5        ┆ 6        │
├╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌┼╌╌╌╌╌╌╌╌╌╌┤
│ 3        ┆ 2        ┆ 3        ┆ 5        ┆ 3        │
└──────────┴──────────┴──────────┴──────────┴──────────┘
</code></pre>
</details>
<h3 id="排序"><a class="header" href="#排序">排序</a></h3>
<p><a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=count#method.sort">sort</a></p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df1: DataFrame = df!(&quot;D1&quot; =&gt; &amp;[1, 3, 1, 5, 6],
                         &quot;D2&quot; =&gt; &amp;[3, 2, 3, 5, 3])?;
println!(&quot;{}&quot;, df1.sort([&quot;D1&quot;], vec![true])?);
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">shape: (5, 2)
┌─────┬─────┐
│ D1  ┆ D2  │
│ --- ┆ --- │
│ i32 ┆ i32 │
╞═════╪═════╡
│ 6   ┆ 3   │
├╌╌╌╌╌┼╌╌╌╌╌┤
│ 5   ┆ 5   │
├╌╌╌╌╌┼╌╌╌╌╌┤
│ 3   ┆ 2   │
├╌╌╌╌╌┼╌╌╌╌╌┤
│ 1   ┆ 3   │
├╌╌╌╌╌┼╌╌╌╌╌┤
│ 1   ┆ 3   │
└─────┴─────┘
</code></pre>
</details>
<h2 id="查询更新数据"><a class="header" href="#查询更新数据">查询&amp;更新数据</a></h2>
<h3 id="获取一个或多个列"><a class="header" href="#获取一个或多个列">获取一个或多个列</a></h3>
<p><a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=index#method.column">column</a>
<a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=index#method.columns">columns</a></p>
<p>这些函数返回一个或多个 <a href="https://pola-rs.github.io/polars/polars/prelude/struct.Series.html">Series</a>.</p>
<p>在 select context 里, 可以用<a href="https://pola-rs.github.io/polars/polars/prelude/fn.col.html#">col</a>
构建一个列选择表达式, 接着对其进行操作.</p>
<p>polars DataFrame 实现了 Index trait, 所以你也可以通过以下方式获取列, 请注意, <strong>pandas 中这种方式拿到的是 slice</strong>.</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df1: DataFrame = df!(&quot;D1&quot; =&gt; &amp;[1, 3, 1, 5, 6],
                         &quot;D2&quot; =&gt; &amp;[3, 2, 3, 5, 3])?;
println!(&quot;{}&quot;, df1[1]);
println!(&quot;{}&quot;, df1[&quot;D1&quot;]);
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">shape: (5,)
Series: 'D2' [i32]
[
        3
        2
        3
        5
        3
]
shape: (5,)
Series: 'D1' [i32]
[
        1
        3
        1
        5
        6
]
</code></pre>
</details>
<h3 id="获取切片"><a class="header" href="#获取切片">获取切片</a></h3>
<p><a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html?search=count#method.slice">slice</a></p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df1: DataFrame = df!(&quot;D1&quot; =&gt; &amp;[1, 3, 1, 5, 6],
                     &quot;D2&quot; =&gt; &amp;[3, 2, 3, 5, 3])?;
println!(&quot;{}&quot;, df1.slice(2, 3));
<span class="boring">}
</span></code></pre></pre>
<p>如果要获取子区域, 可以使用 select + columns</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df1: DataFrame = df!(
    &quot;D1&quot; =&gt; &amp;[1, 3, 1, 5, 6],
    &quot;D2&quot; =&gt; &amp;[3, 2, 3, 5, 3],
    &quot;D3&quot; =&gt; &amp;[9, 7, 5, 2, 4]
)?;
let df2 = df1
    .lazy()
    .select([cols([&quot;D1&quot;, &quot;D3&quot;]).slice(2, 3)])
    .collect()?;
println!(&quot;{}&quot;, df2);
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">shape: (3, 2)
┌─────┬─────┐
│ D1  ┆ D3  │
│ --- ┆ --- │
│ i32 ┆ i32 │
╞═════╪═════╡
│ 1   ┆ 5   │
├╌╌╌╌╌┼╌╌╌╌╌┤
│ 5   ┆ 2   │
├╌╌╌╌╌┼╌╌╌╌╌┤
│ 6   ┆ 4   │
└─────┴─────┘
</code></pre>
</details>
<h3 id="获取某个标量"><a class="header" href="#获取某个标量">获取某个标量</a></h3>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df1: DataFrame = df!(
    &quot;D1&quot; =&gt; &amp;[1, 3, 1, 5, 6],
    &quot;D2&quot; =&gt; &amp;[3, 2, 3, 5, 3],
    &quot;D3&quot; =&gt; &amp;[9, 7, 5, 2, 4]
)?;
println!(&quot;{}&quot;, df1[&quot;D1&quot;].get(0));
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">1
</code></pre>
</details>
<h3 id="布尔索引"><a class="header" href="#布尔索引">布尔索引</a></h3>
<p>polars 中没有布尔索引, 但可以通过 filter 达到相同效果</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df1: DataFrame = df!(
    &quot;D1&quot; =&gt; &amp;[1, 3, 1, 5, 6],
    &quot;D2&quot; =&gt; &amp;[3, 2, 3, 5, 3],
    &quot;D3&quot; =&gt; &amp;[9, 7, 5, 2, 4]
)?;
let df2 = df1.lazy().filter(col(&quot;D1&quot;).gt(3)).collect()?;
println!(&quot;{}&quot;, df2);
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">shape: (2, 3)
┌─────┬─────┬─────┐
│ D1  ┆ D2  ┆ D3  │
│ --- ┆ --- ┆ --- │
│ i32 ┆ i32 ┆ i32 │
╞═════╪═════╪═════╡
│ 5   ┆ 5   ┆ 2   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 6   ┆ 3   ┆ 4   │
└─────┴─────┴─────┘
</code></pre>
</details>
<h3 id="添加新列"><a class="header" href="#添加新列">添加新列</a></h3>
<p>通过 lazy frame 的 <a href="https://pola-rs.github.io/polars/polars/prelude/struct.LazyFrame.html#method.with_column">with_column</a>
可以方便地根据已有列添加新列</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>  let df1: DataFrame = df!(
      &quot;D1&quot; =&gt; &amp;[1, 3, 1, 5, 6],
      &quot;D2&quot; =&gt; &amp;[3, 2, 3, 5, 3],
      &quot;D3&quot; =&gt; &amp;[9, 7, 5, 2, 4]
  )?;
  let df2 = df1
      .lazy()
      .with_column(
          when(col(&quot;D1&quot;).gt(3))
              .then(lit(true))
              .otherwise(lit(false))
              .alias(&quot;D1 &gt; 3&quot;),
      )
      .collect()?;
  println!(&quot;{}&quot;, df2);
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">shape: (5, 4)
┌─────┬─────┬─────┬────────┐
│ D1  ┆ D2  ┆ D3  ┆ D1 &gt; 3 │
│ --- ┆ --- ┆ --- ┆ ---    │
│ i32 ┆ i32 ┆ i32 ┆ bool   │
╞═════╪═════╪═════╪════════╡
│ 1   ┆ 3   ┆ 9   ┆ false  │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┤
│ 3   ┆ 2   ┆ 7   ┆ false  │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┤
│ 1   ┆ 3   ┆ 5   ┆ false  │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┤
│ 5   ┆ 5   ┆ 2   ┆ true   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌╌╌╌┤
│ 6   ┆ 3   ┆ 4   ┆ true   │
└─────┴─────┴─────┴────────┘
</code></pre>
</details>
<h3 id="修改数据"><a class="header" href="#修改数据">修改数据</a></h3>
<p>DataFrame 可以通过 replace + set_at_idx 实现</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let mut df1: DataFrame = df!(
    &quot;D1&quot; =&gt; &amp;[1, 3, 1, 5, 6],
    &quot;D2&quot; =&gt; &amp;[3, 2, 3, 5, 3],
    &quot;D3&quot; =&gt; &amp;[9, 7, 5, 2, 4]
)?;
let new_d1 = df1[&quot;D1&quot;]
    .i32()
    .and_then(|s| s.set_at_idx(vec![0], Some(100)))?;
let df2 = df1.replace(&quot;D1&quot;, new_d1)?;
println!(&quot;{}&quot;, df2);
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">shape: (5, 3)
┌─────┬─────┬─────┐
│ D1  ┆ D2  ┆ D3  │
│ --- ┆ --- ┆ --- │
│ i32 ┆ i32 ┆ i32 │
╞═════╪═════╪═════╡
│ 100 ┆ 3   ┆ 9   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 3   ┆ 2   ┆ 7   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 1   ┆ 3   ┆ 5   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 5   ┆ 5   ┆ 2   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 6   ┆ 3   ┆ 4   │
└─────┴─────┴─────┘
</code></pre>
</details>
<h2 id="缺失值处理"><a class="header" href="#缺失值处理">缺失值处理</a></h2>
<p>在 polars 里缺失值使用 [Null(https://pola-rs.github.io/polars/polars/prelude/struct.Null.html]
表示.</p>
<p>可以通过 <a href="https://pola-rs.github.io/polars/polars/frame/struct.DataFrame.html#method.null_count">null_count</a>,
<a href="https://pola-rs.github.io/polars/polars/series/trait.SeriesTrait.html#method.is_null">is_null</a>
分别查看列是否包含缺失值, 以及缺失值 bit mask.</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df1: DataFrame = df!(
    &quot;D1&quot; =&gt; &amp;[1, 3, 1, 5, 6],
    &quot;D2&quot; =&gt; &amp;[3, 2, 3, 5, 3],
    &quot;D3&quot; =&gt; &amp;[Some(9), Some(7), Some(5), Some(2), None]
)?;
println!(&quot;{}&quot;, df1.null_count());
println!(&quot;{}&quot;, df1[&quot;D3&quot;].is_null().into_series());
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">shape: (1, 3)
┌─────┬─────┬─────┐
│ D1  ┆ D2  ┆ D3  │
│ --- ┆ --- ┆ --- │
│ u32 ┆ u32 ┆ u32 │
╞═════╪═════╪═════╡
│ 0   ┆ 0   ┆ 1   │
└─────┴─────┴─────┘
shape: (5,)
Series: 'D3' [bool]
[
        false
        false
        false
        false
        true
]
</code></pre>
</details>
<h3 id="过滤掉包含缺失值的行"><a class="header" href="#过滤掉包含缺失值的行">过滤掉包含缺失值的行</a></h3>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df1: DataFrame = df!(
    &quot;D1&quot; =&gt; &amp;[1, 2, 3, 4, 5],
    &quot;D2&quot; =&gt; &amp;[Some(3), Some(2), None, Some(5), Some(3)],
    &quot;D3&quot; =&gt; &amp;[Some(9), Some(7), Some(5), Some(2), None]
)?;
let df2 = df1.lazy().filter(all().is_not_null()).collect()?;
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">shape: (3, 3)
┌─────┬─────┬─────┐
│ D1  ┆ D2  ┆ D3  │
│ --- ┆ --- ┆ --- │
│ i32 ┆ i32 ┆ i32 │
╞═════╪═════╪═════╡
│ 1   ┆ 3   ┆ 9   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 2   ┆ 2   ┆ 7   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 4   ┆ 5   ┆ 2   │
└─────┴─────┴─────┘
</code></pre>
</details>
<p>只针对某个列过滤</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df1: DataFrame = df!(
    &quot;D1&quot; =&gt; &amp;[1, 2, 3, 4, 5],
    &quot;D2&quot; =&gt; &amp;[Some(3), Some(2), None, Some(5), Some(3)],
    &quot;D3&quot; =&gt; &amp;[Some(9), Some(7), Some(5), Some(2), None]
)?;
let df2 = df1.lazy().filter(col(&quot;D3&quot;).is_not_null()).collect()?;
println!(&quot;{}&quot;, df2);
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">shape: (4, 3)
┌─────┬──────┬─────┐
│ D1  ┆ D2   ┆ D3  │
│ --- ┆ ---  ┆ --- │
│ i32 ┆ i32  ┆ i32 │
╞═════╪══════╪═════╡
│ 1   ┆ 3    ┆ 9   │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌┤
│ 2   ┆ 2    ┆ 7   │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌┤
│ 3   ┆ null ┆ 5   │
├╌╌╌╌╌┼╌╌╌╌╌╌┼╌╌╌╌╌┤
│ 4   ┆ 5    ┆ 2   │
└─────┴──────┴─────┘
</code></pre>
</details>
<h3 id="填充缺失值"><a class="header" href="#填充缺失值">填充缺失值</a></h3>
<p>填充缺失值的方法大概包括</p>
<ol>
<li>字面量</li>
<li>前向或后向填充</li>
<li>表达式, 例如根据其他列填充</li>
<li>插值</li>
</ol>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let df1: DataFrame = df!(
  &quot;D1&quot; =&gt; &amp;[1, 2, 3, 4, 6],
  &quot;D2&quot; =&gt; &amp;[3, 2, 8, 5, 3],
  &quot;D3&quot; =&gt; &amp;[Some(9), Some(7), None, Some(2), Some(4)]
)?;
// 对全部 null 全部更换为 200
let df2 = df1.clone().lazy().fill_null(lit(200)).collect()?;
println!(&quot;对全部 null 全部更换为 200\n{}&quot;, df2);

// 以下一个值填充
let df2 = df1
  .clone()
  .lazy()
  .with_column(col(&quot;D3&quot;).backward_fill(None))
  .collect()?;
println!(&quot;以下一个值填充\n{}&quot;, df2);

// 以前一个值填充
let df2 = df1
  .clone()
  .lazy()
  .with_column(col(&quot;D3&quot;).forward_fill(None))
  .collect()?;
println!(&quot;以前一个值填充\n{}&quot;, df2);

// 插值
let df2 = df1
  .clone()
  .lazy()
  .with_column(col(&quot;D3&quot;).interpolate())
  .collect()?;
println!(&quot;插值\n{}&quot;, df2);
<span class="boring">}
</span></code></pre></pre>
<details>
    <summary>Output</summary>
<pre><code class="language-bash">对全部 null 全部更换为 200
shape: (5, 3)
┌─────┬─────┬─────┐
│ D1  ┆ D2  ┆ D3  │
│ --- ┆ --- ┆ --- │
│ i32 ┆ i32 ┆ i32 │
╞═════╪═════╪═════╡
│ 1   ┆ 3   ┆ 9   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 2   ┆ 2   ┆ 7   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 3   ┆ 8   ┆ 200 │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 4   ┆ 5   ┆ 2   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 6   ┆ 3   ┆ 4   │
└─────┴─────┴─────┘
以下一个值填充
shape: (5, 3)
┌─────┬─────┬─────┐
│ D1  ┆ D2  ┆ D3  │
│ --- ┆ --- ┆ --- │
│ i32 ┆ i32 ┆ i32 │
╞═════╪═════╪═════╡
│ 1   ┆ 3   ┆ 9   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 2   ┆ 2   ┆ 7   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 3   ┆ 8   ┆ 2   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 4   ┆ 5   ┆ 2   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 6   ┆ 3   ┆ 4   │
└─────┴─────┴─────┘
以前一个值填充
shape: (5, 3)
┌─────┬─────┬─────┐
│ D1  ┆ D2  ┆ D3  │
│ --- ┆ --- ┆ --- │
│ i32 ┆ i32 ┆ i32 │
╞═════╪═════╪═════╡
│ 1   ┆ 3   ┆ 9   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 2   ┆ 2   ┆ 7   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 3   ┆ 8   ┆ 7   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 4   ┆ 5   ┆ 2   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 6   ┆ 3   ┆ 4   │
└─────┴─────┴─────┘
插值
shape: (5, 3)
┌─────┬─────┬─────┐
│ D1  ┆ D2  ┆ D3  │
│ --- ┆ --- ┆ --- │
│ i32 ┆ i32 ┆ i32 │
╞═════╪═════╪═════╡
│ 1   ┆ 3   ┆ 9   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 2   ┆ 2   ┆ 7   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 3   ┆ 8   ┆ 5   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 4   ┆ 5   ┆ 2   │
├╌╌╌╌╌┼╌╌╌╌╌┼╌╌╌╌╌┤
│ 6   ┆ 3   ┆ 4   │
└─────┴─────┴─────┘
</code></pre>
</details>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                

                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="lunr.zh.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
